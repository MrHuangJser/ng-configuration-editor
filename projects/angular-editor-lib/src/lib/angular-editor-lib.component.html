<ng-content select="[toolbar]"></ng-content>
<div class="col p-0 d-flex">
  <div
    #ceDrag="ceDraggable"
    #container
    class="canvas-container"
    ceDraggable
    ceUseSpace
    [class.start-drag]="ceDrag.spaceKeyDown"
    [class.dragging]="startPoints"
    (ceOnStart)="dragStart($event)"
    (ceOnMove)="dragging($event)"
    (ceOnStop)="dragEnd()"
    ceSelector
    [ceSelectorDisabled]="ceDrag.spaceKeyDown"
    (ceOnSelectorStart)="selectorStart()"
    (ceOnSelectorMoving)="selectorMoving($event)"
    (ceOnSelectorStop)="selectorEnd()"
  >
    <div class="canvas-content" [style.transform]="matrix">
      <div ceNoZoomArea>
        <ce-canvas-background></ce-canvas-background>
        <ce-canvas-grid></ce-canvas-grid>
      </div>
      <div ceZoomArea>
        <ce-canvas></ce-canvas>
      </div>
      <div ceNoZoomArea>
        <ce-bordered-area></ce-bordered-area>
        <ce-resize-handle></ce-resize-handle>
        <div cx [class.active]="refLineState?.cx?.state" [style.top.px]="refLineState?.cx?.position * canvasPosition.scale" class="ref-line y"></div>
        <div cy [class.active]="refLineState?.cy?.state" [style.left.px]="refLineState?.cy?.position * canvasPosition.scale" class="ref-line x"></div>
        <div tx [class.active]="refLineState?.tx?.state" [style.top.px]="refLineState?.tx?.position * canvasPosition.scale" class="ref-line y"></div>
        <div bx [class.active]="refLineState?.bx?.state" [style.top.px]="refLineState?.bx?.position * canvasPosition.scale" class="ref-line y"></div>
        <div ly [class.active]="refLineState?.ly?.state" [style.left.px]="refLineState?.ly?.position * canvasPosition.scale" class="ref-line x"></div>
        <div ry [class.active]="refLineState?.ry?.state" [style.left.px]="refLineState?.ry?.position * canvasPosition.scale" class="ref-line x"></div>
      </div>
    </div>
    <div
      class="selector"
      *ngIf="selectorRect"
      [style.left.px]="selectorRect.x"
      [style.top.px]="selectorRect.y"
      [style.width.px]="selectorRect.width"
      [style.height.px]="selectorRect.height"
    ></div>
  </div>
</div>

<ng-container *ngFor="let panel of editorStore.panels$ | async; trackBy: panelsTrackByFn">
  <ce-panel *ngIf="panel.show" [panel]="panel"></ce-panel>
</ng-container>
